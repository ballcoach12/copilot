# Vulnerability Review Instructions for GitHub Copilot

## Overview
These instructions govern GitHub Copilot's approach to comprehensive vulnerability analysis, including CVE assessment, dependency scanning, code reachability analysis, and VEX (Vulnerability Exploitability eXchange) document generation.

## Primary Objectives
- **CVE Impact Assessment**: Determine actual vulnerability impact on specific codebase
- **Dependency Vulnerability Analysis**: Use Syft and Grype for comprehensive dependency scanning
- **Code Reachability Analysis**: Determine if vulnerabilities are exploitable in context
- **VEX Document Generation**: Produce standardized vulnerability exchange documents
- **Exploit Verification**: Practical testing of vulnerability conditions where safe and appropriate

---

## Vulnerability Review Process

### **Phase 1: Initial Setup and Dependency Analysis**

#### **Tool Installation and Verification**
You MUST install and configure vulnerability scanning tools:

**Windows (PowerShell):**
```powershell
# Install Syft for dependency analysis
scoop install syft
# Or using other package managers as appropriate

# Install Grype for vulnerability scanning
scoop install grype
# Or using other package managers as appropriate

# Verify installations
syft --version
grype --version
```

**Linux:**
```bash
# Install Syft for dependency analysis
# Using curl (recommended method)
curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin

# Or using package managers:
# Ubuntu/Debian with apt
curl -1sLf 'https://dl.cloudsmith.io/public/anchore/syft/setup.deb.sh' | sudo -E bash
sudo apt update && sudo apt install syft

# RHEL/CentOS/Fedora with yum/dnf
curl -1sLf 'https://dl.cloudsmith.io/public/anchore/syft/setup.rpm.sh' | sudo -E bash
sudo yum install syft

# Alpine Linux with apk
apk add --no-cache syft

# Install Grype for vulnerability scanning
# Using curl (recommended method)
curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin

# Or using package managers:
# Ubuntu/Debian with apt
curl -1sLf 'https://dl.cloudsmith.io/public/anchore/grype/setup.deb.sh' | sudo -E bash
sudo apt update && sudo apt install grype

# RHEL/CentOS/Fedora with yum/dnf
curl -1sLf 'https://dl.cloudsmith.io/public/anchore/grype/setup.rpm.sh' | sudo -E bash
sudo yum install grype

# Alpine Linux with apk
apk add --no-cache grype

# Verify installations
syft --version
grype --version
```

#### **Dependency Discovery with Syft**
Execute comprehensive dependency analysis:

**Windows (PowerShell):**
```powershell
# Generate SBOM (Software Bill of Materials) in multiple formats
syft . -o json > sbom.json
syft . -o spdx-json > sbom.spdx.json
syft . -o cyclone-json > sbom.cyclone.json
syft . -o table > sbom.txt

# For specific package managers if needed
syft . --scope all-layers -o json > sbom-detailed.json
```

**Linux (Bash):**
```bash
# Generate SBOM (Software Bill of Materials) in multiple formats
syft . -o json > sbom.json
syft . -o spdx-json > sbom.spdx.json
syft . -o cyclone-json > sbom.cyclone.json
syft . -o table > sbom.txt

# For specific package managers if needed
syft . --scope all-layers -o json > sbom-detailed.json
```

#### **Vulnerability Scanning with Grype**
Execute vulnerability scanning against dependencies:

**Windows (PowerShell):**
```powershell
# Scan against generated SBOM
grype sbom.json -o json > vulnerabilities.json
grype sbom.json -o table > vulnerabilities.txt

# Direct scanning of repository
grype . -o json > direct-vulnerabilities.json

# Scan with specific vulnerability databases
grype . --add-cpes-if-none -o json > enhanced-vulnerabilities.json
```

**Linux (Bash):**
```bash
# Scan against generated SBOM
grype sbom.json -o json > vulnerabilities.json
grype sbom.json -o table > vulnerabilities.txt

# Direct scanning of repository
grype . -o json > direct-vulnerabilities.json

# Scan with specific vulnerability databases
grype . --add-cpes-if-none -o json > enhanced-vulnerabilities.json
```

### **Phase 2: CVE Analysis and NIST Integration**

#### **CVE Detail Retrieval from NIST**
For each CVE identified in Jira issues, you MUST:

1. **Connect to NIST NVD Database**: Retrieve authoritative CVE information
2. **Extract CVE Details**: Description, CVSS scores, affected versions, attack vectors
3. **Analyze Vulnerability Conditions**: Prerequisites for exploitation
4. **Document Attack Vectors**: How the vulnerability can be exploited

#### **NIST CVE Analysis Framework**
```markdown
**CVE Analysis Template for NIST Integration:**

### CVE-YYYY-NNNNN Analysis

**NIST NVD Information Retrieved**: [Timestamp of data retrieval]
**CVE Description**: [Official NIST description]
**CVSS Base Score**: [Score and vector string]
**Attack Vector**: [Network/Adjacent/Local/Physical]
**Attack Complexity**: [Low/High]
**Privileges Required**: [None/Low/High]
**User Interaction**: [None/Required]
**Scope**: [Unchanged/Changed]
**Confidentiality Impact**: [None/Low/High]
**Integrity Impact**: [None/Low/High] 
**Availability Impact**: [None/Low/High]

**Affected Software**: [Specific versions and components from NIST]
**References**: [Security advisories and patches from NIST data]
**Vendor Information**: [Official vendor statements and fixes]
```

### **Phase 3: Code Reachability Analysis**

#### **Abstract Syntax Tree Analysis**
You MUST perform deep code analysis to determine vulnerability reachability:

```markdown
**Code Reachability Analysis Framework:**

1. **Dependency Path Tracing**:
   - Map vulnerable dependency to actual usage locations
   - Trace call paths from entry points to vulnerable code
   - Identify if vulnerable functions are actually invoked

2. **AST Analysis Requirements**:
   - Parse source code to build abstract syntax tree
   - Identify function calls to vulnerable dependencies
   - Analyze data flow to vulnerable code paths
   - Document unreachable code paths that contain vulnerabilities

3. **Static Analysis Integration**:
   - Use language-specific static analysis tools
   - Generate call graphs showing vulnerability exposure
   - Identify dead code that may contain vulnerabilities
   - Document configuration-dependent reachability
```

#### **Dynamic Analysis and Exploitation Testing**

**CRITICAL SAFETY REQUIREMENTS**:
- **Isolated Environment**: All exploit testing MUST be conducted in isolated development environments
- **No Production Data**: Never use production data or credentials in vulnerability testing
- **Controlled Scope**: Limit testing to specific vulnerability conditions only
- **Documentation**: Thoroughly document all testing procedures and results

#### **Safe Exploitation Testing Protocol**
```markdown
**Vulnerability Exploitation Testing Framework:**

### Pre-Testing Safety Checklist
- [ ] Isolated development environment confirmed
- [ ] No production connections or credentials
- [ ] Backup of testing environment created
- [ ] Limited scope testing plan documented
- [ ] Rollback procedures prepared

### Testing Methodology
1. **Environment Preparation**:
   - Create minimal reproduction environment
   - Install vulnerable dependency versions
   - Set up controlled test data
   - Prepare monitoring and logging

2. **Exploit Development**:
   - Research public exploit code and techniques
   - Adapt exploits to specific codebase context
   - Create proof-of-concept demonstrations
   - Document exploitation procedures

3. **Impact Assessment**:
   - Execute controlled exploitation attempts
   - Document actual impact vs. theoretical impact
   - Measure data exposure, system compromise, or service disruption
   - Validate or refute CVE severity ratings for this context

4. **Mitigation Verification**:
   - Test proposed patches or workarounds
   - Verify that mitigations prevent exploitation
   - Document residual risks after mitigation
```

### **Phase 4: VEX Document Generation**

#### **VEX Document Structure and Standards**
Generate standardized VEX documents following industry standards:

#### **VEX Document Template**
```markdown
# Vulnerability Exploitability eXchange (VEX) Document
**Document ID**: VEX-[YYYYMMDDHHMM]
**Generated**: [Full timestamp in local time]
**Author**: GitHub Copilot Vulnerability Review System
**Codebase**: [Repository name and commit hash]
**Analysis Date**: [Date of analysis]

---

## Document Metadata
- **VEX Format Version**: 1.0
- **Document Version**: 1.0
- **Document Status**: [Draft/Final/Updated]
- **Confidence Level**: [High/Medium/Low based on analysis depth]
- **Analysis Methodology**: [Brief description of analysis approach]

## Executive Summary
**Total CVEs Analyzed**: [Number]
**Exploitable Vulnerabilities**: [Number with High confidence]
**Non-Exploitable Vulnerabilities**: [Number with justification]
**Mitigated Vulnerabilities**: [Number with existing protections]
**Requires Immediate Action**: [Number of critical findings]

## Vulnerability Assessments

### CVE-YYYY-NNNNN: [CVE Title]

**Product Information**:
- **Affected Component**: [Specific dependency and version]
- **Component Role**: [How component is used in codebase]
- **Installation Path**: [Where component is installed/referenced]

**NIST CVE Details**:
- **Official Description**: [NIST description]
- **CVSS Base Score**: [Score] ([Vector string])
- **Attack Vector**: [Details from NIST]
- **Impact**: [Confidentiality/Integrity/Availability impacts]

**Dependency Analysis**:
- **Direct/Indirect Dependency**: [Relationship to codebase]
- **Usage Locations**: [Specific files and functions using vulnerable code]
- **Data Flow Analysis**: [How data flows to/from vulnerable component]

**Reachability Analysis**:
- **Vulnerability Reachable**: [Yes/No with confidence level]
- **Code Path Analysis**: [Specific paths from entry points to vulnerable code]
- **Attack Surface**: [Exposed interfaces that could trigger vulnerability]
- **Prerequisites for Exploitation**: [Conditions required for successful attack]

**Exploitation Assessment**:
- **Exploitation Attempted**: [Yes/No]
- **Exploitation Successful**: [Yes/No with details]
- **Actual Impact Observed**: [Results of controlled testing]
- **Exploit Complexity**: [Assessment of real-world exploitation difficulty]

**Risk Assessment**:
- **Risk Level**: [Critical/High/Medium/Low]
- **Business Impact**: [Potential business consequences]
- **Technical Impact**: [System compromise, data exposure, service disruption]
- **Likelihood of Exploitation**: [Assessment based on attack surface and complexity]

**Mitigation Status**:
- **Current Mitigations**: [Existing protections that reduce risk]
- **Recommended Actions**: [Specific steps to address vulnerability]
- **Patch Availability**: [Available updates and their status]
- **Workaround Options**: [Alternative mitigations if patching not immediately possible]

**VEX Statement**: [One of: "Affected", "Not Affected", "Fixed", "Under Investigation"]
**Justification**: [Detailed reasoning for VEX statement]

---

## Syft and Grype Analysis Results

### Dependency Inventory Summary
[Summary of all dependencies discovered by Syft]

### Vulnerability Scan Results  
[Summary of all vulnerabilities identified by Grype]

### Tool Configuration
- **Syft Version**: [Version used]
- **Grype Version**: [Version used] 
- **Vulnerability Database**: [Database version and date]
- **Scan Date**: [When scans were executed]

## Enhanced GitHub Copilot Prompts for Follow-up Actions

### Immediate Remediation Prompt
[For Critical and High-risk vulnerabilities requiring immediate action]

### Strategic Vulnerability Management Prompt  
[For broader vulnerability management improvements]

### Dependency Management Enhancement Prompt
[For improving dependency management practices]

## Quality Assurance

### Analysis Confidence Levels
- **High Confidence**: Thorough analysis including exploitation testing
- **Medium Confidence**: Static analysis and dependency tracing completed
- **Low Confidence**: Limited analysis due to constraints or complexity

### Analysis Limitations
[Any limitations in the analysis process or scope]

### Recommendations for Further Analysis
[Areas requiring additional investigation or expert review]

---

## Appendices

### Appendix A: Technical Analysis Details
[Detailed technical findings, code snippets, and analysis results]

### Appendix B: Tool Output
[Relevant excerpts from Syft and Grype analysis]

### Appendix C: References
[NIST CVE links, security advisories, and other references]

### Appendix D: Change Log
[Document revision history and updates]
```

### **Phase 5: Jira Integration and Issue Management**

#### **Vulnerability Issue Creation Standards**
Create structured Jira issues for each vulnerability finding:

#### **Jira Issue Template for Vulnerabilities**
```markdown
**Issue Type**: Vulnerability
**Priority**: [Critical/High/Medium/Low based on VEX analysis]
**Component**: [Affected system component]
**Security Level**: [Based on data sensitivity and system criticality]

**Summary**: CVE-YYYY-NNNNN - [Vulnerability title] in [Component name]

**Description**:
**CVE Details**:
- CVE ID: CVE-YYYY-NNNNN
- CVSS Score: [Score] ([Severity])
- Affected Component: [Component name and version]
- Attack Vector: [Network/Local/etc.]

**Impact Assessment**:
- Vulnerability Reachable: [Yes/No]
- Exploitation Risk: [Critical/High/Medium/Low] 
- Business Impact: [Description of potential business consequences]
- Technical Impact: [System compromise details]

**Analysis Results**:
- Dependency Analysis: [How component is used]
- Code Reachability: [Whether vulnerable code paths are accessible]
- Exploitation Testing: [Results of controlled testing]
- Current Mitigations: [Existing protections]

**Recommended Actions**:
1. [Immediate actions required]
2. [Medium-term improvements]
3. [Long-term strategic changes]

**Acceptance Criteria**:
- [ ] Vulnerability patched or mitigated
- [ ] Mitigation effectiveness verified
- [ ] Dependencies updated to secure versions
- [ ] Security testing confirms fix
- [ ] Documentation updated

**VEX Document Reference**: VEX-[YYYYMMDDHHMM].md

**Enhanced GitHub Copilot Prompt for Implementation**:
"I need to address CVE-YYYY-NNNNN vulnerability in [component].

VULNERABILITY CONTEXT: [Summary of CVE and impact]
REACHABILITY ANALYSIS: [Whether vulnerability is exploitable in this context]
RISK ASSESSMENT: [Business and technical risk level]

You WILL implement comprehensive vulnerability remediation by:
- MANDATORY: Updating vulnerable dependencies to secure versions
- CRITICAL: Implementing additional security controls if patching not immediately possible
- You MUST: Verify mitigation effectiveness through testing
- You WILL: Update security documentation and monitoring

IMPLEMENTATION REQUIREMENTS:
1. Research available patches and security updates
2. Test compatibility of updates in development environment
3. Implement updates with appropriate change management
4. Verify that vulnerability is no longer exploitable
5. Update dependency management policies to prevent similar issues"
```

## Critical Guidelines and Best Practices

### **Safety and Security Requirements**
- **Never compromise production systems** during vulnerability testing
- **Always use isolated environments** for exploitation testing
- **Document all testing procedures** for audit and repeatability
- **Limit access to vulnerability details** to authorized personnel only
- **Follow responsible disclosure practices** for any new vulnerabilities discovered

### **Quality Assurance Standards**
- **Multiple verification methods** for each vulnerability assessment
- **Peer review of critical vulnerability analyses** where possible  
- **Regular updates to vulnerability databases** and scanning tools
- **Continuous monitoring** for new vulnerabilities affecting analyzed components

### **Documentation Requirements**
- **Comprehensive VEX documents** for all vulnerability assessments
- **Detailed analysis notes** including methodology and findings
- **Clear remediation guidance** with specific implementation steps
- **Regular updates** to vulnerability status as mitigations are implemented

---

## Enhanced GitHub Copilot Integration

### **Vulnerability Discovery Prompt**
```
"I need to conduct comprehensive vulnerability analysis for this codebase.

ANALYSIS SCOPE: [Specific components or full system analysis]
JIRA ISSUES PROVIDED: [List of CVEs to investigate]
RISK CONTEXT: [Business criticality and data sensitivity]

You WILL execute systematic vulnerability review by:
- MANDATORY: Installing and running Syft and Grype for dependency analysis
- CRITICAL: Retrieving detailed CVE information from NIST database
- You MUST: Perform code reachability analysis using AST and static analysis
- You WILL: Conduct safe exploitation testing in isolated environments
- ESSENTIAL: Generate comprehensive VEX document with findings

ANALYSIS REQUIREMENTS:
1. Complete dependency inventory with SBOM generation
2. Cross-reference dependencies against known vulnerabilities
3. Analyze code paths to determine actual exploitability
4. Document risk assessment with business impact analysis
5. Provide specific remediation guidance with implementation steps
6. Create structured Jira issues for tracking remediation efforts"
```

### **Vulnerability Remediation Prompt**
```
"I need to implement comprehensive remediation for identified vulnerabilities.

VULNERABILITY CONTEXT: [Specific CVEs and affected components]
BUSINESS IMPACT: [Criticality and urgency level]
TECHNICAL CONSTRAINTS: [System dependencies and change restrictions]

You WILL implement systematic vulnerability remediation by:
- MANDATORY: Prioritizing remediation based on exploitability and business impact
- CRITICAL: Testing all updates in isolated development environments
- You MUST: Verifying remediation effectiveness through re-testing
- You WILL: Updating security monitoring and alerting for ongoing protection

REMEDIATION REQUIREMENTS:
1. Research and evaluate available patches and updates
2. Assess compatibility impact of security updates
3. Implement updates using appropriate change management
4. Verify vulnerabilities are no longer exploitable
5. Update security documentation and incident response procedures
6. Establish ongoing monitoring for similar vulnerability patterns"
```

This comprehensive vulnerability review framework ensures thorough, safe, and documented vulnerability analysis with practical remediation guidance and proper integration with existing development workflows.